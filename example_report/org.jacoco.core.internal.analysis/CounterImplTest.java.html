<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/highlight_report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>CounterImplTest.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">jacoco</a> &gt; <a href="index.source.html" class="el_package">org.jacoco.core.internal.analysis</a> &gt; <span class="el_source">CounterImplTest.java</span></div><h1>CounterImplTest.java</h1><pre class="source lang-java linenums">/*******************************************************************************
 * Copyright (c) 2009, 2016 Mountainminds GmbH &amp; Co. KG and Contributors
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-v10.html
 *
 * Contributors:
 *    Marc R. Hoffmann - initial API and implementation
 *    
 *******************************************************************************/
package org.jacoco.core.internal.analysis;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertFalse;
import static org.junit.Assert.assertNotSame;
import static org.junit.Assert.assertSame;

import org.jacoco.core.analysis.ICounter;
import org.jacoco.core.analysis.ICounter.CounterValue;
import org.junit.Test;

/**
 * Unit tests for {@link CounterImpl}.
 */
<span class="fc" id="L26">public class CounterImplTest {</span>

	@Test
	public void testGetInstance1() {
<span class="fc" id="L30">		ICounter c = CounterImpl.getInstance(0, 0);</span>
<span class="fc" id="L31">		assertEquals(0, c.getTotalCount());</span>
<span class="fc" id="L32">		assertEquals(0.0, c.getValue(CounterValue.TOTALCOUNT), 0.0);</span>
<span class="fc" id="L33">		assertEquals(0, c.getMissedCount());</span>
<span class="fc" id="L34">		assertEquals(0.0, c.getValue(CounterValue.MISSEDCOUNT), 0.0);</span>
<span class="fc" id="L35">		assertEquals(0, c.getCoveredCount());</span>
<span class="fc" id="L36">		assertEquals(0.0, c.getValue(CounterValue.COVEREDCOUNT), 0.0);</span>
<span class="fc" id="L37">	}</span>

	@Test
	public void testGetInstance2() {
<span class="fc" id="L41">		ICounter c = CounterImpl.getInstance(33, 15);</span>
<span class="fc" id="L42">		assertEquals(48, c.getTotalCount());</span>
<span class="fc" id="L43">		assertEquals(48.0, c.getValue(CounterValue.TOTALCOUNT), 0.0);</span>
<span class="fc" id="L44">		assertEquals(33, c.getMissedCount());</span>
<span class="fc" id="L45">		assertEquals(33.0, c.getValue(CounterValue.MISSEDCOUNT), 0.0);</span>
<span class="fc" id="L46">		assertEquals(15, c.getCoveredCount());</span>
<span class="fc" id="L47">		assertEquals(15.0, c.getValue(CounterValue.COVEREDCOUNT), 0.0);</span>
<span class="fc" id="L48">	}</span>

	@Test
	public void testGetInstance3() {
<span class="fc" id="L52">		ICounter c = CounterImpl.getInstance(15, 12);</span>
<span class="fc" id="L53">		ICounter copy = CounterImpl.getInstance(c);</span>
<span class="fc" id="L54">		assertEquals(27, copy.getTotalCount());</span>
<span class="fc" id="L55">		assertEquals(27.0, c.getValue(CounterValue.TOTALCOUNT), 0.0);</span>
<span class="fc" id="L56">		assertEquals(15, copy.getMissedCount());</span>
<span class="fc" id="L57">		assertEquals(15.0, c.getValue(CounterValue.MISSEDCOUNT), 0.0);</span>
<span class="fc" id="L58">		assertEquals(12, copy.getCoveredCount());</span>
<span class="fc" id="L59">		assertEquals(12.0, c.getValue(CounterValue.COVEREDCOUNT), 0.0);</span>
<span class="fc" id="L60">	}</span>

	@Test
	public void testFixInstance() {
<span class="fc" id="L64">		ICounter c1 = CounterImpl.getInstance(30, 30);</span>
<span class="fc" id="L65">		ICounter c2 = CounterImpl.getInstance(30, 30);</span>
<span class="fc" id="L66">		assertSame(c1, c2);</span>
<span class="fc" id="L67">	}</span>

	@Test
	public void testVarInstance() {
<span class="fc" id="L71">		ICounter c1 = CounterImpl.getInstance(31, 30);</span>
<span class="fc" id="L72">		ICounter c2 = CounterImpl.getInstance(31, 30);</span>
<span class="fc" id="L73">		assertNotSame(c1, c2);</span>
<span class="fc" id="L74">	}</span>

	@Test
	public void testIncrement1() {
<span class="fc" id="L78">		CounterImpl c = CounterImpl.getInstance(1, 1);</span>
<span class="fc" id="L79">		c = c.increment(CounterImpl.getInstance(2, 1));</span>
<span class="fc" id="L80">		assertEquals(3, c.getMissedCount());</span>
<span class="fc" id="L81">		assertEquals(2, c.getCoveredCount());</span>
<span class="fc" id="L82">	}</span>

	@Test
	public void testIncrement2() {
<span class="fc" id="L86">		CounterImpl c = CounterImpl.getInstance(31, 5);</span>
<span class="fc" id="L87">		c = c.increment(CounterImpl.getInstance(7, 3));</span>
<span class="fc" id="L88">		assertEquals(38, c.getMissedCount());</span>
<span class="fc" id="L89">		assertEquals(8, c.getCoveredCount());</span>
<span class="fc" id="L90">	}</span>

	@Test
	public void testGetCoveredRatio1() {
<span class="fc" id="L94">		ICounter c = CounterImpl.getInstance(30, 10);</span>
<span class="fc" id="L95">		assertEquals(0.25, c.getCoveredRatio(), 0.0);</span>
<span class="fc" id="L96">		assertEquals(0.25, c.getValue(CounterValue.COVEREDRATIO), 0.0);</span>
<span class="fc" id="L97">	}</span>

	@Test
	public void testGetCoveredRatio2() {
<span class="fc" id="L101">		ICounter c = CounterImpl.getInstance(20, 0);</span>
<span class="fc" id="L102">		assertEquals(0.0, c.getCoveredRatio(), 0.0);</span>
<span class="fc" id="L103">		assertEquals(0.0, c.getValue(CounterValue.COVEREDRATIO), 0.0);</span>
<span class="fc" id="L104">	}</span>

	@Test
	public void testGetCoveredRatio3() {
<span class="fc" id="L108">		ICounter c = CounterImpl.getInstance(0, 0);</span>
<span class="fc" id="L109">		assertEquals(Double.NaN, c.getCoveredRatio(), 0.0);</span>
<span class="fc" id="L110">		assertEquals(Double.NaN, c.getValue(CounterValue.COVEREDRATIO), 0.0);</span>
<span class="fc" id="L111">	}</span>

	@Test
	public void testGetMissedRatio1() {
<span class="fc" id="L115">		ICounter c = CounterImpl.getInstance(10, 30);</span>
<span class="fc" id="L116">		assertEquals(0.25, c.getMissedRatio(), 0.0);</span>
<span class="fc" id="L117">		assertEquals(0.25, c.getValue(CounterValue.MISSEDRATIO), 0.0);</span>
<span class="fc" id="L118">	}</span>

	@Test
	public void testGetMissedRatio2() {
<span class="fc" id="L122">		ICounter c = CounterImpl.getInstance(0, 20);</span>
<span class="fc" id="L123">		assertEquals(0.0, c.getMissedRatio(), 0.0);</span>
<span class="fc" id="L124">		assertEquals(0.0, c.getValue(CounterValue.MISSEDRATIO), 0.0);</span>
<span class="fc" id="L125">	}</span>

	@Test
	public void testGetMissedRatio3() {
<span class="fc" id="L129">		ICounter c = CounterImpl.getInstance(0, 0);</span>
<span class="fc" id="L130">		assertEquals(Double.NaN, c.getMissedRatio(), 0.0);</span>
<span class="fc" id="L131">		assertEquals(Double.NaN, c.getValue(CounterValue.MISSEDRATIO), 0.0);</span>
<span class="fc" id="L132">	}</span>

	@Test
	public void testGetMissedStatus1() {
<span class="fc" id="L136">		ICounter c = CounterImpl.getInstance(0, 0);</span>
<span class="fc" id="L137">		assertEquals(ICounter.EMPTY, c.getStatus());</span>
<span class="fc" id="L138">	}</span>

	@Test
	public void testGetMissedStatus2() {
<span class="fc" id="L142">		ICounter c = CounterImpl.getInstance(5, 0);</span>
<span class="fc" id="L143">		assertEquals(ICounter.NOT_COVERED, c.getStatus());</span>
<span class="fc" id="L144">	}</span>

	@Test
	public void testGetMissedStatus3() {
<span class="fc" id="L148">		ICounter c = CounterImpl.getInstance(0, 5);</span>
<span class="fc" id="L149">		assertEquals(ICounter.FULLY_COVERED, c.getStatus());</span>
<span class="fc" id="L150">	}</span>

	@Test
	public void testGetMissedStatus4() {
<span class="fc" id="L154">		ICounter c = CounterImpl.getInstance(2, 3);</span>
<span class="fc" id="L155">		assertEquals(ICounter.PARTLY_COVERED, c.getStatus());</span>
<span class="fc" id="L156">	}</span>

	@Test
	public void testEquals1() {
<span class="fc" id="L160">		ICounter c1 = CounterImpl.getInstance(300, 123);</span>
<span class="fc" id="L161">		ICounter c2 = CounterImpl.getInstance(300, 123);</span>
<span class="fc" id="L162">		assertEquals(c1, c2);</span>
<span class="fc" id="L163">	}</span>

	@Test
	public void testEquals2() {
<span class="fc" id="L167">		ICounter c1 = CounterImpl.getInstance(300, 123);</span>
<span class="fc" id="L168">		ICounter c2 = CounterImpl.getInstance(400, 123);</span>
<span class="fc" id="L169">		assertFalse(c1.equals(c2));</span>
<span class="fc" id="L170">	}</span>

	@Test
	public void testEquals3() {
<span class="fc" id="L174">		ICounter c1 = CounterImpl.getInstance(300, 123);</span>
<span class="fc" id="L175">		ICounter c2 = CounterImpl.getInstance(300, 124);</span>
<span class="fc" id="L176">		assertFalse(c1.equals(c2));</span>
<span class="fc" id="L177">	}</span>

	@Test
	public void testEquals4() {
<span class="fc" id="L181">		ICounter c = CounterImpl.getInstance(300, 123);</span>
<span class="fc" id="L182">		assertFalse(c.equals(new Integer(123)));</span>
<span class="fc" id="L183">	}</span>

	@Test
	public void testHashCode1() {
<span class="fc" id="L187">		ICounter c1 = CounterImpl.getInstance(300, 123);</span>
<span class="fc" id="L188">		ICounter c2 = CounterImpl.getInstance(300, 123);</span>
<span class="fc" id="L189">		assertEquals(c1.hashCode(), c2.hashCode());</span>
<span class="fc" id="L190">	}</span>

	@Test
	public void testHashCode2() {
<span class="fc" id="L194">		ICounter c1 = CounterImpl.getInstance(300, 123);</span>
<span class="fc" id="L195">		ICounter c2 = CounterImpl.getInstance(400, 123);</span>
<span class="pc bpc" id="L196" title="1 of 2 branches missed.">		assertFalse(c1.hashCode() == c2.hashCode());</span>
<span class="fc" id="L197">	}</span>

	@Test
	public void testHashCode3() {
<span class="fc" id="L201">		ICounter c1 = CounterImpl.getInstance(300, 123);</span>
<span class="fc" id="L202">		ICounter c2 = CounterImpl.getInstance(300, 124);</span>
<span class="pc bpc" id="L203" title="1 of 2 branches missed.">		assertFalse(c1.hashCode() == c2.hashCode());</span>
<span class="fc" id="L204">	}</span>

	@Test
	public void testToString() {
<span class="fc" id="L208">		ICounter c = CounterImpl.getInstance(300, 123);</span>
<span class="fc" id="L209">		assertEquals(&quot;Counter[300/123]&quot;, c.toString());</span>
<span class="fc" id="L210">	}</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.6.201602180812</span></div></body></html>